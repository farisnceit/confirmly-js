import{createPopper as e}from"@popperjs/core";function t(e,t,o){return function(e,t){for(var o=0;o<t.length;o++){var i=t[o];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,n(i.key),i)}}(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function n(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var o=n.call(e,t);if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e,"string");return"symbol"==typeof t?t:t+""}var o=function(){return t((function e(t){var o,i,r,a=t.template,s=t.buttonClasses,l=void 0===s?{confirm:"confirmly__button confirmly__button--confirm",cancel:"confirmly__button confirmly__button--cancel"}:s,c=t.buttonContents,p=void 0===c?{confirm:"Yes",cancel:"No"}:c,u=t.defaultPlacement,d=void 0===u?"top":u,h=t.targetElement,m=t.onConfirm,f=t.onCancel,v=t.showError,y=void 0===v||v;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),o=this,r=null,(i=n(i="popperInstance"))in o?Object.defineProperty(o,i,{value:r,enumerable:!0,configurable:!0,writable:!0}):o[i]=r,this.template=a||this.defaultTemplate(),this.buttonClasses=l,this.buttonContents=p,this.defaultPlacement=d,this.showError=y,this.popperElement=this.createPopperElement(),document.body.appendChild(this.popperElement),h?this.attach(h,m,f):this.showError&&console.error("Target Element is not defined")}),[{key:"defaultTemplate",value:function(){return'\n      <div class="confirmly__popup">\n        <div class="confirmly__content">\n          <p class="confirmly__message">Are you sure?</p>\n          <div class="confirmly__buttons">\n            <button class="{{confirmClass}}" data-button="cancel">{{cancelContent}}</button>\n            <button class="{{confirmClass}}" data-button="confirm">{{confirmContent}}</button>\n          </div>\n        </div>\n        <div class="confirmly__arrow" data-popper-arrow></div>\n      </div>\n    '}},{key:"createPopperElement",value:function(){var e=document.createElement("div");e.className="confirmly",e.style.display="none";var t=this.template.replace("{{confirmClass}}",this.buttonClasses.confirm).replace("{{cancelClass}}",this.buttonClasses.cancel).replace("{{confirmContent}}",this.buttonContents.confirm).replace("{{cancelContent}}",this.buttonContents.cancel);return e.innerHTML=t,this.attachButtonListeners(e),e}},{key:"attachButtonListeners",value:function(e){var t=e.querySelector('[data-button="confirm"]'),n=e.querySelector('[data-button="cancel"]');t&&t.addEventListener("click",this.handleConfirm.bind(this)),n&&n.addEventListener("click",this.handleCancel.bind(this))}},{key:"attach",value:function(e,t,n){var o=this;e||!this.showError?(this.onConfirmCallback=t,this.onCancelCallback=n,null==e||e.addEventListener("click",(function(t){t.preventDefault(),t.stopPropagation(),o.showPopper(e)})),document.addEventListener("click",this.handleOutsideClick.bind(this)),document.addEventListener("keydown",this.handleEscapeKey.bind(this))):console.error("Target Element is not defined")}},{key:"destroy",value:function(){this.popperInstance&&(this.popperInstance.destroy(),this.popperInstance=null),this.popperElement.remove(),document.removeEventListener("click",this.handleOutsideClick.bind(this)),document.removeEventListener("keydown",this.handleEscapeKey.bind(this))}},{key:"handleOutsideClick",value:function(e){this.popperElement.contains(e.target)||this.hidePopper()}},{key:"handleEscapeKey",value:function(e){"Escape"===e.key&&this.hidePopper()}},{key:"showPopper",value:function(t){this.popperElement.style.display="block";var n=this.popperElement.querySelector(".confirmly__popup");n&&requestAnimationFrame((function(){n.classList.add("confirmly__popup--visible")})),this.popperInstance&&this.popperInstance.destroy(),this.popperInstance=e(t,this.popperElement,{placement:this.defaultPlacement,modifiers:[{name:"offset",options:{offset:[0,8]}},{name:"arrow",options:{element:"[data-popper-arrow]",padding:8}},{name:"preventOverflow",options:{padding:8,boundary:"viewport"}}]})}},{key:"hidePopper",value:function(){var e=this,t=this.popperElement.querySelector(".confirmly__popup");t&&(t.classList.remove("confirmly__popup--visible"),setTimeout((function(){e.popperInstance&&(e.popperInstance.destroy(),e.popperInstance=null),e.popperElement.style.display="none"}),200))}},{key:"handleConfirm",value:function(){var e;null===(e=this.onConfirmCallback)||void 0===e||e.call(this),this.hidePopper()}},{key:"handleCancel",value:function(){var e;null===(e=this.onCancelCallback)||void 0===e||e.call(this),this.hidePopper()}}])}();export{o as ConfirmPopup};
//# sourceMappingURL=confirmly-popup.esm.min.js.map
