{"version":3,"file":"confirmly-popup.umd.js","sources":["../src/confirmlyPopup.ts"],"sourcesContent":["import { createPopper, Instance as PopperInstance, Placement } from '@popperjs/core';\nimport { PopperOptions } from './constants';\n\nexport class ConfirmPopup {\n  private popperInstance: PopperInstance | null = null;\n  private readonly template: string;\n  private readonly buttonClasses: { confirm: string; cancel: string };\n  private readonly buttonContents: { confirm: string; cancel: string };\n  private readonly defaultPlacement: Placement;\n  private readonly popperElement: HTMLElement;\n  private onConfirmCallback?: () => void;\n  private onCancelCallback?: () => void;\n  private readonly showError: boolean;\n\n  constructor({\n    template,\n    buttonClasses = { \n      confirm: 'confirmly__button confirmly__button--confirm', \n      cancel: 'confirmly__button confirmly__button--cancel' \n    },\n    buttonContents = { confirm: 'Yes', cancel: 'No' },\n    defaultPlacement = 'top',\n    targetElement,\n    onConfirm,\n    onCancel,\n    showError = true,\n  }: PopperOptions) {\n    this.template = template || this.defaultTemplate();\n    this.buttonClasses = buttonClasses;\n    this.buttonContents = buttonContents;\n    this.defaultPlacement = defaultPlacement;\n    this.showError = showError;\n\n    this.popperElement = this.createPopperElement();\n    document.body.appendChild(this.popperElement);\n\n    if (targetElement) {\n      this.attach(targetElement, onConfirm, onCancel);\n    } else if (this.showError) {\n      console.error('Target Element is not defined');\n    }\n  }\n\n  private defaultTemplate(): string {\n    return `\n      <div class=\"confirmly__popup\">\n        <div class=\"confirmly__content\">\n          <p class=\"confirmly__message\">Are you sure?</p>\n          <div class=\"confirmly__buttons\">\n            <button class=\"{{confirmClass}}\" data-button=\"cancel\">{{cancelContent}}</button>\n            <button class=\"{{confirmClass}}\" data-button=\"confirm\">{{confirmContent}}</button>\n          </div>\n        </div>\n        <div class=\"confirmly__arrow\" data-popper-arrow></div>\n      </div>\n    `;\n  }\n\n  private createPopperElement(): HTMLElement {\n    const popperDiv = document.createElement('div');\n    popperDiv.className = 'confirmly';\n    popperDiv.style.display = 'none';\n\n    const template = this.template\n      .replace('{{confirmClass}}', this.buttonClasses.confirm)\n      .replace('{{cancelClass}}', this.buttonClasses.cancel)\n      .replace('{{confirmContent}}', this.buttonContents.confirm)\n      .replace('{{cancelContent}}', this.buttonContents.cancel);\n\n    popperDiv.innerHTML = template;\n    this.attachButtonListeners(popperDiv);\n\n    return popperDiv;\n  }\n\n  private attachButtonListeners(popperDiv: HTMLElement): void {\n    const confirmButton = popperDiv.querySelector('[data-button=\"confirm\"]');\n    const cancelButton = popperDiv.querySelector('[data-button=\"cancel\"]');\n\n    if (confirmButton) {\n      confirmButton.addEventListener('click', this.handleConfirm.bind(this));\n    }\n\n    if (cancelButton) {\n      cancelButton.addEventListener('click', this.handleCancel.bind(this));\n    }\n  }\n\n  public attach(\n    element: HTMLElement,\n    onConfirm?: () => void,\n    onCancel?: () => void,\n  ): void {\n    if (!element && this.showError) {\n      console.error('Target Element is not defined');\n      return;\n    }\n\n    this.onConfirmCallback = onConfirm;\n    this.onCancelCallback = onCancel;\n\n    element?.addEventListener('click', (event) => {\n      event.preventDefault();\n      event.stopPropagation();\n      this.showPopper(element);\n    });\n\n    document.addEventListener('click', this.handleOutsideClick.bind(this));\n    document.addEventListener('keydown', this.handleEscapeKey.bind(this));\n  }\n\n  public destroy(): void {\n    if (this.popperInstance) {\n      this.popperInstance.destroy();\n      this.popperInstance = null;\n    }\n    this.popperElement.remove();\n    document.removeEventListener('click', this.handleOutsideClick.bind(this));\n    document.removeEventListener('keydown', this.handleEscapeKey.bind(this));\n  }\n\n  private handleOutsideClick(event: MouseEvent): void {\n    if (!this.popperElement.contains(event.target as Node)) {\n      this.hidePopper();\n    }\n  }\n\n  private handleEscapeKey(event: KeyboardEvent): void {\n    if (event.key === 'Escape') {\n      this.hidePopper();\n    }\n  }\n\n  private showPopper(targetElement: HTMLElement) {\n    this.popperElement.style.display = 'block';\n    const popup = this.popperElement.querySelector('.confirmly__popup');\n    \n    if (popup) {\n      // Add visible class after a small delay to trigger animation\n      requestAnimationFrame(() => {\n        popup.classList.add('confirmly__popup--visible');\n      });\n    }\n\n    if (this.popperInstance) {\n      this.popperInstance.destroy();\n    }\n\n    this.popperInstance = createPopper(targetElement, this.popperElement, {\n      placement: this.defaultPlacement,\n      modifiers: [\n        {\n          name: 'offset',\n          options: {\n            offset: [0, 8],\n          },\n        },\n        {\n          name: 'arrow',\n          options: {\n            element: '[data-popper-arrow]',\n            padding: 8,\n          },\n        },\n        {\n          name: 'preventOverflow',\n          options: {\n            padding: 8,\n            boundary: 'viewport',\n          },\n        },\n      ],\n    });\n  }\n\n  private hidePopper(): void {\n    const popup = this.popperElement.querySelector('.confirmly__popup');\n    \n    if (popup) {\n      popup.classList.remove('confirmly__popup--visible');\n      // Wait for animation to complete\n      setTimeout(() => {\n        if (this.popperInstance) {\n          this.popperInstance.destroy();\n          this.popperInstance = null;\n        }\n        this.popperElement.style.display = 'none';\n      }, 200);\n    }\n  }\n\n  private handleConfirm(): void {\n    this.onConfirmCallback?.();\n    this.hidePopper();\n  }\n\n  private handleCancel(): void {\n    this.onCancelCallback?.();\n    this.hidePopper();\n  }\n}\n"],"names":["ConfirmPopup","_ref","template","_ref$buttonClasses","buttonClasses","confirm","cancel","_ref$buttonContents","buttonContents","_ref$defaultPlacement","defaultPlacement","targetElement","onConfirm","onCancel","_ref$showError","showError","_classCallCheck","_defineProperty","defaultTemplate","popperElement","createPopperElement","document","body","appendChild","attach","console","error","_createClass","key","value","popperDiv","createElement","className","style","display","replace","innerHTML","attachButtonListeners","confirmButton","querySelector","cancelButton","addEventListener","handleConfirm","bind","handleCancel","element","_this","onConfirmCallback","onCancelCallback","event","preventDefault","stopPropagation","showPopper","handleOutsideClick","handleEscapeKey","destroy","popperInstance","remove","removeEventListener","contains","target","hidePopper","popup","requestAnimationFrame","classList","add","createPopper","placement","modifiers","name","options","offset","padding","boundary","_this2","setTimeout","_this$onConfirmCallba","call","_this$onCancelCallbac"],"mappings":"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"}