{"version":3,"file":"confirmly-popup.umd.js","sources":["../src/confirmlyPopup.ts"],"sourcesContent":["\r\nimport Popper from '@popperjs/core';\r\n\r\ninterface PopperOptions {\r\n  template?: string;\r\n  buttonClasses?: { confirm: string; cancel: string };\r\n  buttonContents?: { confirm: string; cancel: string };\r\n  defaultPlacement?: Popper.Placement;\r\n  targetElement: HTMLElement;\r\n  onConfirm?: () => void;\r\n  onCancel?: () => void;\r\n}\r\n\r\nexport class confirmPopup {\r\n  private popperInstance: any = null;\r\n  private template: string;\r\n  private buttonClasses: { confirm: string; cancel: string };\r\n  private buttonContents: { confirm: string; cancel: string };\r\n  private defaultPlacement: Popper.Placement;\r\n  private popperElement: HTMLElement;\r\n  private onConfirmCallback?: () => void;\r\n  private onCancelCallback?: () => void;\r\n\r\n  constructor({\r\n    template,\r\n    buttonClasses,\r\n    buttonContents,\r\n    defaultPlacement,\r\n    targetElement,\r\n    onConfirm,\r\n    onCancel,\r\n  }: PopperOptions) {\r\n    this.template = template || this.defaultTemplate();\r\n    this.buttonClasses = buttonClasses || {\r\n      confirm: 'confirm-btn',\r\n      cancel: 'cancel-btn',\r\n    };\r\n    this.buttonContents = buttonContents || { confirm: 'Yes', cancel: 'No' };\r\n    this.defaultPlacement = defaultPlacement || 'top';\r\n\r\n    this.popperElement = this.createPopperElement();\r\n    document.body.appendChild(this.popperElement);\r\n\r\n    this.attach(targetElement, onConfirm, onCancel);\r\n  }\r\n\r\n  private defaultTemplate(): string {\r\n    return `\r\n      <div class=\"confirmation-content\">\r\n        <p>Are you sure?</p>\r\n        <div class=\"arrow\" data-popper-arrow></div>\r\n        <button class=\"{{confirmClass}}\">{{confirmContent}}</button>\r\n        <button class=\"{{cancelClass}}\">{{cancelContent}}</button>\r\n      </div>\r\n    `;\r\n  }\r\n\r\n  private createPopperElement(): HTMLElement {\r\n    const popperDiv = document.createElement('div');\r\n    popperDiv.className = 'confirmation-popper';\r\n    popperDiv.style.display = 'none';\r\n    popperDiv.style.position = 'absolute';\r\n\r\n    const template = this.template\r\n      .replace('{{confirmClass}}', this.buttonClasses.confirm)\r\n      .replace('{{cancelClass}}', this.buttonClasses.cancel)\r\n      .replace('{{confirmContent}}', this.buttonContents.confirm)\r\n      .replace('{{cancelContent}}', this.buttonContents.cancel);\r\n\r\n    popperDiv.innerHTML = template;\r\n\r\n    const confirmClass = this.buttonClasses.confirm.replace(' ', '.');\r\n\r\n    popperDiv\r\n      .querySelector(`.${confirmClass}`)\r\n      ?.addEventListener('click', () => {\r\n        this.handleConfirm();\r\n      });\r\n\r\n    const cancelClass = this.buttonClasses.cancel.replace(' ', '.');\r\n\r\n    popperDiv\r\n      .querySelector(`.${cancelClass}`)\r\n      ?.addEventListener('click', () => {\r\n        this.handleCancel();\r\n      });\r\n\r\n    return popperDiv;\r\n  }\r\n\r\n  public attach(\r\n    element: HTMLElement,\r\n    onConfirm?: () => void,\r\n    onCancel?: () => void,\r\n  ): void {\r\n    element.addEventListener('click', (event) => {\r\n      event.stopPropagation();\r\n      this.showPopper(element, onConfirm, onCancel);\r\n    });\r\n\r\n    document.addEventListener('click', (event) => {\r\n      if (!this.popperElement.contains(event.target as Node)) {\r\n        this.hidePopper();\r\n      }\r\n    });\r\n  }\r\n\r\n  private showPopper(\r\n    targetElement: HTMLElement,\r\n    onConfirm?: () => void,\r\n    onCancel?: () => void,\r\n  ) {\r\n    this.onConfirmCallback = onConfirm;\r\n    this.onCancelCallback = onCancel;\r\n\r\n    this.popperElement.style.display = 'block';\r\n\r\n    if (this.popperInstance) {\r\n      this.popperInstance.destroy();\r\n    }\r\n\r\n    this.popperInstance = Popper.createPopper(targetElement, this.popperElement, {\r\n      placement: this.defaultPlacement,\r\n      modifiers: [\r\n        {\r\n          name: 'offset',\r\n          options: {\r\n            offset: [0, 8],\r\n          },\r\n        },\r\n        {\r\n          name: 'arrow',\r\n          options: {\r\n            element: '[data-popper-arrow]',\r\n          },\r\n        },\r\n      ],\r\n    });\r\n  }\r\n\r\n  private hidePopper() {\r\n    if (this.popperInstance) {\r\n      this.popperInstance.destroy();\r\n      this.popperInstance = null;\r\n    }\r\n    this.popperElement.style.display = 'none';\r\n  }\r\n\r\n  private handleConfirm() {\r\n    if (this.onConfirmCallback) {\r\n      this.onConfirmCallback();\r\n    }\r\n    this.hidePopper();\r\n  }\r\n\r\n  private handleCancel() {\r\n    if (this.onCancelCallback) {\r\n      this.onCancelCallback();\r\n    }\r\n    this.hidePopper();\r\n  }\r\n}\r\n"],"names":["confirmPopup","_ref","template","buttonClasses","buttonContents","defaultPlacement","targetElement","onConfirm","onCancel","_classCallCheck","_defineProperty","defaultTemplate","confirm","cancel","popperElement","createPopperElement","document","body","appendChild","attach","_createClass","key","value","_popperDiv$querySelec","_this","_popperDiv$querySelec2","popperDiv","createElement","className","style","display","position","replace","innerHTML","confirmClass","querySelector","concat","addEventListener","handleConfirm","cancelClass","handleCancel","element","_this2","event","stopPropagation","showPopper","contains","target","hidePopper","onConfirmCallback","onCancelCallback","popperInstance","destroy","Popper","createPopper","placement","modifiers","name","options","offset"],"mappings":"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"}