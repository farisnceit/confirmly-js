{"version":3,"file":"confirmly-popup.esm.min.js","sources":["../src/confirmlyPopup.ts"],"sourcesContent":["import Popper from '@popperjs/core';\n\nimport { PopperOptions } from './constants'\n\nexport class confirmPopup {\n  private popperInstance: any = null;\n  private template: string;\n  private buttonClasses: { confirm: string; cancel: string };\n  private buttonContents: { confirm: string; cancel: string };\n  private defaultPlacement: Popper.Placement;\n  private popperElement: HTMLElement;\n  private onConfirmCallback?: () => void;\n  private onCancelCallback?: () => void;\n  private showError: boolean;\n\n  constructor({\n    template,\n    buttonClasses,\n    buttonContents,\n    defaultPlacement,\n    targetElement,\n    onConfirm,\n    onCancel,\n    showError = true,\n  }: PopperOptions) {\n    this.template = template || this.defaultTemplate();\n    this.buttonClasses = buttonClasses || {\n      confirm: 'confirm-btn',\n      cancel: 'cancel-btn',\n    };\n    this.buttonContents = buttonContents || { confirm: 'Yes', cancel: 'No' };\n    this.defaultPlacement = defaultPlacement || 'top';\n    this.showError = showError;\n\n    this.popperElement = this.createPopperElement();\n    document.body.appendChild(this.popperElement);\n\n    this.attach(targetElement, onConfirm, onCancel);\n  }\n\n  private defaultTemplate(): string {\n    return `\n      <div class=\"confirmation-content\">\n        <p>Are you sure?</p>\n        <div class=\"arrow\" data-popper-arrow></div>\n        <button class=\"{{confirmClass}}\" data-button=\"confirm\">{{confirmContent}}</button>\n        <button class=\"{{cancelClass}}\" data-button=\"cancel\">{{cancelContent}}</button>\n      </div>\n    `;\n  }\n\n  private createPopperElement(): HTMLElement {\n    const popperDiv = document.createElement('div');\n    popperDiv.className = 'confirmation-popper';\n    popperDiv.style.display = 'none';\n    popperDiv.style.position = 'absolute';\n\n    const template = this.template\n      .replace('{{confirmClass}}', this.buttonClasses.confirm)\n      .replace('{{cancelClass}}', this.buttonClasses.cancel)\n      .replace('{{confirmContent}}', this.buttonContents.confirm)\n      .replace('{{cancelContent}}', this.buttonContents.cancel);\n\n    popperDiv.innerHTML = template;\n\n    // Ensure event listeners are added dynamically after template insertion\n    this.attachButtonListeners(popperDiv);\n\n    return popperDiv;\n  }\n\n  private attachButtonListeners(popperDiv: HTMLElement): void {\n    const confirmButton = popperDiv.querySelector('[data-button=\"confirm\"]');\n    const cancelButton = popperDiv.querySelector('[data-button=\"cancel\"]');\n\n    if (confirmButton) {\n      confirmButton.addEventListener('click', () => {\n        this.handleConfirm();\n      });\n    }\n\n    if (cancelButton) {\n      cancelButton.addEventListener('click', () => {\n        this.handleCancel();\n      });\n    }\n  }\n\n  public attach(\n    element: HTMLElement,\n    onConfirm?: () => void,\n    onCancel?: () => void,\n  ): void {\n    if (!!element && this.showError) {\n      console.error('Target Element is not Defined');\n    }\n\n    element?.addEventListener('click', (event) => {\n      event.stopPropagation();\n      this.showPopper(element, onConfirm, onCancel);\n    });\n\n    document.addEventListener('click', (event) => {\n      if (!this.popperElement.contains(event.target as Node)) {\n        this.hidePopper();\n      }\n    });\n  }\n\n  private showPopper(\n    targetElement: HTMLElement,\n    onConfirm?: () => void,\n    onCancel?: () => void,\n  ) {\n    this.onConfirmCallback = onConfirm;\n    this.onCancelCallback = onCancel;\n\n    this.popperElement.style.display = 'block';\n\n    if (this.popperInstance) {\n      this.popperInstance.destroy();\n    }\n\n    if (!!targetElement && this.showError) {\n      console.error('Target Element is not Defined');\n    }\n\n    this.popperInstance = Popper.createPopper(\n      targetElement,\n      this.popperElement,\n      {\n        placement: this.defaultPlacement,\n        modifiers: [\n          {\n            name: 'offset',\n            options: {\n              offset: [0, 8],\n            },\n          },\n          {\n            name: 'arrow',\n            options: {\n              element: '[data-popper-arrow]',\n            },\n          },\n        ],\n      },\n    );\n  }\n\n  private hidePopper() {\n    if (this.popperInstance) {\n      this.popperInstance.destroy();\n      this.popperInstance = null;\n    }\n    this.popperElement.style.display = 'none';\n  }\n\n  private handleConfirm() {\n    if (this.onConfirmCallback) {\n      this.onConfirmCallback();\n    }\n    this.hidePopper();\n  }\n\n  private handleCancel() {\n    if (this.onCancelCallback) {\n      this.onCancelCallback();\n    }\n    this.hidePopper();\n  }\n}\n"],"names":["confirmPopup","_createClass","_ref","template","buttonClasses","buttonContents","defaultPlacement","targetElement","onConfirm","onCancel","_ref$showError","showError","undefined","_classCallCheck","this","defaultTemplate","confirm","cancel","popperElement","createPopperElement","document","body","appendChild","attach","key","value","popperDiv","createElement","className","style","display","position","replace","innerHTML","attachButtonListeners","_this","confirmButton","querySelector","cancelButton","addEventListener","handleConfirm","handleCancel","element","_this2","console","error","event","stopPropagation","showPopper","contains","target","hidePopper","onConfirmCallback","onCancelCallback","popperInstance","destroy","Popper","createPopper","placement","modifiers","name","options","offset"],"mappings":"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"}