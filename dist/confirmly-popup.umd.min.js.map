{"version":3,"file":"confirmly-popup.umd.min.js","sources":["../src/confirmlyPopup.ts"],"sourcesContent":["\r\nimport Popper from '@popperjs/core';\r\n\r\ninterface PopperOptions {\r\n  template?: string;\r\n  buttonClasses?: { confirm: string; cancel: string };\r\n  buttonContents?: { confirm: string; cancel: string };\r\n  defaultPlacement?: Popper.Placement;\r\n  targetElement: HTMLElement;\r\n  onConfirm?: () => void;\r\n  onCancel?: () => void;\r\n}\r\n\r\nexport class confirmPopup {\r\n  private popperInstance: any = null;\r\n  private template: string;\r\n  private buttonClasses: { confirm: string; cancel: string };\r\n  private buttonContents: { confirm: string; cancel: string };\r\n  private defaultPlacement: Popper.Placement;\r\n  private popperElement: HTMLElement;\r\n  private onConfirmCallback?: () => void;\r\n  private onCancelCallback?: () => void;\r\n\r\n  constructor({\r\n    template,\r\n    buttonClasses,\r\n    buttonContents,\r\n    defaultPlacement,\r\n    targetElement,\r\n    onConfirm,\r\n    onCancel,\r\n  }: PopperOptions) {\r\n    this.template = template || this.defaultTemplate();\r\n    this.buttonClasses = buttonClasses || {\r\n      confirm: 'confirm-btn',\r\n      cancel: 'cancel-btn',\r\n    };\r\n    this.buttonContents = buttonContents || { confirm: 'Yes', cancel: 'No' };\r\n    this.defaultPlacement = defaultPlacement || 'top';\r\n\r\n    this.popperElement = this.createPopperElement();\r\n    document.body.appendChild(this.popperElement);\r\n\r\n    this.attach(targetElement, onConfirm, onCancel);\r\n  }\r\n\r\n  private defaultTemplate(): string {\r\n    return `\r\n      <div class=\"confirmation-content\">\r\n        <p>Are you sure?</p>\r\n        <div class=\"arrow\" data-popper-arrow></div>\r\n        <button class=\"{{confirmClass}}\">{{confirmContent}}</button>\r\n        <button class=\"{{cancelClass}}\">{{cancelContent}}</button>\r\n      </div>\r\n    `;\r\n  }\r\n\r\n  private createPopperElement(): HTMLElement {\r\n    const popperDiv = document.createElement('div');\r\n    popperDiv.className = 'confirmation-popper';\r\n    popperDiv.style.display = 'none';\r\n    popperDiv.style.position = 'absolute';\r\n\r\n    const template = this.template\r\n      .replace('{{confirmClass}}', this.buttonClasses.confirm)\r\n      .replace('{{cancelClass}}', this.buttonClasses.cancel)\r\n      .replace('{{confirmContent}}', this.buttonContents.confirm)\r\n      .replace('{{cancelContent}}', this.buttonContents.cancel);\r\n\r\n    popperDiv.innerHTML = template;\r\n\r\n    const confirmClass = this.buttonClasses.confirm.replace(' ', '.');\r\n\r\n    popperDiv\r\n      .querySelector(`.${confirmClass}`)\r\n      ?.addEventListener('click', () => {\r\n        this.handleConfirm();\r\n      });\r\n\r\n    const cancelClass = this.buttonClasses.cancel.replace(' ', '.');\r\n\r\n    popperDiv\r\n      .querySelector(`.${cancelClass}`)\r\n      ?.addEventListener('click', () => {\r\n        this.handleCancel();\r\n      });\r\n\r\n    return popperDiv;\r\n  }\r\n\r\n  public attach(\r\n    element: HTMLElement,\r\n    onConfirm?: () => void,\r\n    onCancel?: () => void,\r\n  ): void {\r\n    element.addEventListener('click', (event) => {\r\n      event.stopPropagation();\r\n      this.showPopper(element, onConfirm, onCancel);\r\n    });\r\n\r\n    document.addEventListener('click', (event) => {\r\n      if (!this.popperElement.contains(event.target as Node)) {\r\n        this.hidePopper();\r\n      }\r\n    });\r\n  }\r\n\r\n  private showPopper(\r\n    targetElement: HTMLElement,\r\n    onConfirm?: () => void,\r\n    onCancel?: () => void,\r\n  ) {\r\n    this.onConfirmCallback = onConfirm;\r\n    this.onCancelCallback = onCancel;\r\n\r\n    this.popperElement.style.display = 'block';\r\n\r\n    if (this.popperInstance) {\r\n      this.popperInstance.destroy();\r\n    }\r\n\r\n    this.popperInstance = Popper.createPopper(targetElement, this.popperElement, {\r\n      placement: this.defaultPlacement,\r\n      modifiers: [\r\n        {\r\n          name: 'offset',\r\n          options: {\r\n            offset: [0, 8],\r\n          },\r\n        },\r\n        {\r\n          name: 'arrow',\r\n          options: {\r\n            element: '[data-popper-arrow]',\r\n          },\r\n        },\r\n      ],\r\n    });\r\n  }\r\n\r\n  private hidePopper() {\r\n    if (this.popperInstance) {\r\n      this.popperInstance.destroy();\r\n      this.popperInstance = null;\r\n    }\r\n    this.popperElement.style.display = 'none';\r\n  }\r\n\r\n  private handleConfirm() {\r\n    if (this.onConfirmCallback) {\r\n      this.onConfirmCallback();\r\n    }\r\n    this.hidePopper();\r\n  }\r\n\r\n  private handleCancel() {\r\n    if (this.onCancelCallback) {\r\n      this.onCancelCallback();\r\n    }\r\n    this.hidePopper();\r\n  }\r\n}\r\n"],"names":["confirmPopup","_createClass","_ref","template","buttonClasses","buttonContents","defaultPlacement","targetElement","onConfirm","onCancel","_classCallCheck","this","defaultTemplate","confirm","cancel","popperElement","createPopperElement","document","body","appendChild","attach","key","value","_popperDiv$querySelec","_popperDiv$querySelec2","_this","popperDiv","createElement","className","style","display","position","replace","innerHTML","confirmClass","querySelector","concat","addEventListener","handleConfirm","cancelClass","handleCancel","element","_this2","event","stopPropagation","showPopper","contains","target","hidePopper","onConfirmCallback","onCancelCallback","popperInstance","destroy","Popper","createPopper","placement","modifiers","name","options","offset"],"mappings":"ilBAaaA,IAAAA,EAAY,WA+BtB,OAAAC,GArBD,SAAAD,EAAAE,GAQkB,UAPhBC,EAAQD,EAARC,SACAC,EAAaF,EAAbE,cACAC,EAAcH,EAAdG,eACAC,EAAgBJ,EAAhBI,iBACAC,EAAaL,EAAbK,cACAC,EAASN,EAATM,UACAC,EAAQP,EAARO,sGAAQC,MAAAV,YAhBoB,yHAkB5BW,KAAKR,SAAWA,GAAYQ,KAAKC,kBACjCD,KAAKP,cAAgBA,GAAiB,CACpCS,QAAS,cACTC,OAAQ,cAEVH,KAAKN,eAAiBA,GAAkB,CAAEQ,QAAS,MAAOC,OAAQ,MAClEH,KAAKL,iBAAmBA,GAAoB,MAE5CK,KAAKI,cAAgBJ,KAAKK,sBAC1BC,SAASC,KAAKC,YAAYR,KAAKI,eAE/BJ,KAAKS,OAAOb,EAAeC,EAAWC,EACxC,GAAC,CAAA,CAAAY,IAAA,kBAAAC,MAED,WACE,MAAA,6RAQF,GAAC,CAAAD,IAAA,sBAAAC,MAED,WAA2C,IAAAC,EAAAC,EAAAC,EAAAd,KACnCe,EAAYT,SAASU,cAAc,OACzCD,EAAUE,UAAY,sBACtBF,EAAUG,MAAMC,QAAU,OAC1BJ,EAAUG,MAAME,SAAW,WAE3B,IAAM5B,EAAWQ,KAAKR,SACnB6B,QAAQ,mBAAoBrB,KAAKP,cAAcS,SAC/CmB,QAAQ,kBAAmBrB,KAAKP,cAAcU,QAC9CkB,QAAQ,qBAAsBrB,KAAKN,eAAeQ,SAClDmB,QAAQ,oBAAqBrB,KAAKN,eAAeS,QAEpDY,EAAUO,UAAY9B,EAEtB,IAAM+B,EAAevB,KAAKP,cAAcS,QAAQmB,QAAQ,IAAK,KAGzBT,QADpCA,EAAAG,EACGS,cAAaC,IAAAA,OAAKF,eAAeX,GADpCA,EAEIc,iBAAiB,SAAS,WAC1BZ,EAAKa,eACP,IAEF,IAAMC,EAAc5B,KAAKP,cAAcU,OAAOkB,QAAQ,IAAK,KAQ3D,OALmCR,QADnCA,EAAAE,EACGS,cAAaC,IAAAA,OAAKG,eAAcf,GADnCA,EAEIa,iBAAiB,SAAS,WAC1BZ,EAAKe,cACP,IAEKd,CACT,GAAC,CAAAL,IAAA,SAAAC,MAED,SACEmB,EACAjC,EACAC,GACM,IAAAiC,EAAA/B,KACN8B,EAAQJ,iBAAiB,SAAS,SAACM,GACjCA,EAAMC,kBACNF,EAAKG,WAAWJ,EAASjC,EAAWC,EACtC,IAEAQ,SAASoB,iBAAiB,SAAS,SAACM,GAC7BD,EAAK3B,cAAc+B,SAASH,EAAMI,SACrCL,EAAKM,YAET,GACF,GAAC,CAAA3B,IAAA,aAAAC,MAED,SACEf,EACAC,EACAC,GAEAE,KAAKsC,kBAAoBzC,EACzBG,KAAKuC,iBAAmBzC,EAExBE,KAAKI,cAAcc,MAAMC,QAAU,QAE/BnB,KAAKwC,gBACPxC,KAAKwC,eAAeC,UAGtBzC,KAAKwC,eAAiBE,EAAOC,aAAa/C,EAAeI,KAAKI,cAAe,CAC3EwC,UAAW5C,KAAKL,iBAChBkD,UAAW,CACT,CACEC,KAAM,SACNC,QAAS,CACPC,OAAQ,CAAC,EAAG,KAGhB,CACEF,KAAM,QACNC,QAAS,CACPjB,QAAS,0BAKnB,GAAC,CAAApB,IAAA,aAAAC,MAED,WACMX,KAAKwC,iBACPxC,KAAKwC,eAAeC,UACpBzC,KAAKwC,eAAiB,MAExBxC,KAAKI,cAAcc,MAAMC,QAAU,MACrC,GAAC,CAAAT,IAAA,gBAAAC,MAED,WACMX,KAAKsC,mBACPtC,KAAKsC,oBAEPtC,KAAKqC,YACP,GAAC,CAAA3B,IAAA,eAAAC,MAED,WACMX,KAAKuC,kBACPvC,KAAKuC,mBAEPvC,KAAKqC,YACP,IAAC,CAnJsB"}